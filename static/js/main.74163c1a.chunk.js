(this.webpackJsonpblackjack=this.webpackJsonpblackjack||[]).push([[0],{16:function(e,t,n){e.exports={GameRound:"GameRound_GameRound__St2ql",cards:"GameRound_cards__3-lpi",round:"GameRound_round__1zS6w",cardsContainer:"GameRound_cardsContainer__aGNyG",roundNumber:"GameRound_roundNumber__3-f6Q",score:"GameRound_score__3g3mO",gameRoundHandlers:"GameRound_gameRoundHandlers__2Oy80"}},26:function(e,t,n){e.exports={Game:"Game_Game__3OBnI",Button:"Game_Button__2gD4V",credit:"Game_credit__1sMef",Info:"Game_Info__1Bo99",dealBtns:"Game_dealBtns__14f6W",goldText:"Game_goldText__20k-l"}},27:function(e,t,n){e.exports={Chip:"Chip_Chip__15gnN",red:"Chip_red__3iB90",green:"Chip_green__VfWSm",blue:"Chip_blue__fWd6X",gray:"Chip_gray__en79z",black:"Chip_black__1m-pp",goldText:"Chip_goldText__3PX4L"}},34:function(e,t,n){e.exports={RoundHistory:"RoundHistory_RoundHistory__WuEJi",hidden:"RoundHistory_hidden__3_Vjo",cards:"RoundHistory_cards__16r-K",goldText:"RoundHistory_goldText__1zYx2"}},43:function(e,t,n){e.exports={Ranking:"Ranking_Ranking__1Pk0Z",goldText:"Ranking_goldText__1welU"}},48:function(e,t,n){e.exports={Card:"Card_Card__16tpa"}},62:function(e,t,n){},63:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(8),c=n.n(r),i=(n(62),n(17)),o=n(18),d=n(22),l=n(20),u=n(98),h=(n(63),n(44)),j=n(25),b=n(23),m=n(99),O=n(26),f=n.n(O),p=n(27),v=n.n(p),g=n(1),x=[v.a.red,v.a.green,v.a.blue,v.a.gray,v.a.black],k=[1,5,10,100,1e3],_=function(e){var t=e.clickCallback;return Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{className:v.a.goldText,children:"Place a bet and play!"}),k.map((function(e,n){return Object(g.jsx)("button",{onClick:function(){return t(e)},className:"".concat(v.a.Chip," ").concat(x[n]),"data-testid":"Chip",children:Object(g.jsx)("div",{children:e})},e)}))]})};_.defaultProps={};var y=_,S="https://deckofcardsapi.com/api/deck/",C="RANKING_KEY",R={saveState:function(e,t){localStorage.setItem(e,JSON.stringify(t))},getState:function(e){return JSON.parse(localStorage.getItem(e))}},G=n(16),N=n.n(G),D=n(48),w=n.n(D),E=function(e){var t=e.image;return Object(g.jsxs)("div",{className:w.a.Card,"data-testid":"Card",children:[Object(g.jsx)("img",{src:t,alt:"card"}),Object(g.jsx)("img",{src:"bag-147782_1280.png",alt:"Credit"})]})};E.defaultProps={image:"card.png"};var H=E,P=function(e){Object(d.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).calculateScore=function(e){var t=0,n=0;for(e.forEach((function(e){Number(e.value)?t+=Number(e.value):"ACE"===e.value?n+=1:t+=10}));n>0;)t+=t+11+(n-=1)<=21?11:1;return t},a.state={playerCards:[],dealerCards:[],playerScore:0,dealerScore:0,betDoubled:!1,showDealersFstCard:!1},a.onEndOfRound=a.props.onEndOfRound.bind(Object(b.a)(a)),a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=R.getState("GAME_ROUND_KEY");this.props.continueLastGame&&e?this.setState(e):this.startGameRound()}},{key:"componentWillUnmount",value:function(){this.props.saveGameRound(this.state)}},{key:"handleHit",value:function(){var e=this;this.getCards(1).then((function(t){return e.setState((function(n){return{playerCards:[].concat(Object(j.a)(n.playerCards),[t.cards[0]]),playerScore:e.calculateScore([].concat(Object(j.a)(n.playerCards),[t.cards[0]]))}}),(function(){e.state.playerScore>=21&&e.checkResult(),e.handleDealersMovement(!0)}))}))}},{key:"handleStand",value:function(){this.handleDealersMovement(!1)}},{key:"handleDoubleDown",value:function(){var e=this;this.setState({betDoubled:!0},(function(){return e.handleDealersMovement(!1)}))}},{key:"handleDealersMovement",value:function(e){var t=this;this.state.dealerScore<=16?this.getCards(1).then((function(n){return t.setState((function(e){return{dealerCards:[].concat(Object(j.a)(e.dealerCards),[n.cards[0]]),dealerScore:t.calculateScore([].concat(Object(j.a)(e.dealerCards),[n.cards[0]])),showDealersFstCard:!0}}),(function(){t.state.dealerScore<=16&&!e?t.handleDealersMovement(!1):e||t.checkResult()}))})):e||this.checkResult()}},{key:"getCards",value:function(e){return fetch("".concat(S).concat(this.props.deckID,"/draw/?count=").concat(e)).then((function(e){return e.json()}))}},{key:"checkResult",value:function(){var e="player";this.state.playerScore>21||this.state.dealerScore<21&&this.state.playerScore<this.state.dealerScore?e="dealer":this.state.playerScore<21&&this.state.playerScore===this.state.dealerScore&&(e="ex aequo"),this.onEndOfRound({number:this.props.roundNumber,winner:e,betDoubled:this.state.betDoubled,playerCards:this.state.playerCards,dealerCards:this.state.dealerCards})}},{key:"startGameRound",value:function(){var e=this;this.getCards(4).then((function(t){return e.setState({playerCards:[t.cards[0],t.cards[1]],playerScore:e.calculateScore([t.cards[0],t.cards[1]]),dealerCards:[t.cards[2],t.cards[3]],dealerScore:e.calculateScore([t.cards[2],t.cards[3]])},(function(){e.state.playerScore>=21&&e.checkResult()}))}))}},{key:"render",value:function(){var e=this,t=this.state.playerCards.map((function(e){return Object(g.jsx)(H,{image:e.image},JSON.stringify(e))})),n=this.state.dealerCards.map((function(t,n){return 0!==n||e.state.showDealersFstCard?Object(g.jsx)(H,{image:t.image},t):Object(g.jsx)(H,{},t)})),a=Object(g.jsxs)("div",{id:N.a.gameRoundHandlers,children:[Object(g.jsx)(u.a,{onClick:function(){return e.handleHit()},children:"Hit"}),Object(g.jsx)(u.a,{onClick:function(){return e.handleStand()},children:"Stand"}),Object(g.jsx)(u.a,{disabled:2===!this.state.playerCards.length,onClick:function(){return e.handleDoubleDown()},children:"Double down"})]}),s=this.state.showDealersFstCard&&Object(g.jsxs)("span",{id:N.a.score,children:["Score: ",this.state.dealerScore]});return Object(g.jsxs)("div",{className:N.a.GameRound,"data-testid":"GameRound",children:[Object(g.jsxs)("div",{children:[Object(g.jsxs)("span",{id:N.a.roundNumber,children:["Round ",this.props.roundNumber]}),Object(g.jsxs)("div",{id:N.a.round,children:[Object(g.jsxs)("div",{className:N.a.cardsContainer,children:[Object(g.jsx)("span",{children:"Player"}),Object(g.jsx)("div",{className:N.a.cards,children:t}),Object(g.jsxs)("span",{id:N.a.score,children:["Score: ",this.state.playerScore]})]}),Object(g.jsxs)("div",{className:N.a.cardsContainer,children:[Object(g.jsx)("span",{children:"Dealer"}),Object(g.jsx)("div",{className:N.a.cards,children:n}),s]})]})]}),a,Object(g.jsx)("div",{id:"appButtons",children:Object(g.jsx)(u.a,{onClick:function(){e.props.saveGameRound(e.state),window.confirm("Game has been saved")},children:"Save game"})})]})}}]),n}(a.Component),B=n(34),I=n.n(B),L=function(e){Object(d.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={historyHidden:!0},a}return Object(o.a)(n,[{key:"toggleHistory",value:function(){this.setState((function(e){return{historyHidden:!e.historyHidden}}))}},{key:"render",value:function(){var e=this;return console.log(this.props.rounds),Object(g.jsxs)("div",{"data-testid":"RoundHistory",id:"appButtons",children:[Object(g.jsx)(u.a,{onClick:function(){return e.toggleHistory()},children:this.state.historyHidden?"show round history":"hide round history"}),Object(g.jsxs)("div",{className:this.state.historyHidden?I.a.hidden:I.a.RoundHistory,children:[Object(g.jsx)("span",{className:I.a.goldText,children:"Round history"}),Object(g.jsxs)("table",{children:[Object(g.jsx)("thead",{children:Object(g.jsxs)("tr",{children:[Object(g.jsx)("th",{children:"Round"}),Object(g.jsx)("th",{children:"Winner"}),Object(g.jsx)("th",{children:"Players cards"}),Object(g.jsx)("th",{children:"Dealers cards"}),Object(g.jsx)("th",{children:"Score"})]})}),Object(g.jsx)("tbody",{children:this.props.rounds.map((function(e){return Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{children:e.number}),Object(g.jsx)("td",{children:e.winner}),Object(g.jsx)("td",{className:I.a.cards,children:Object(g.jsx)("div",{children:e.playerCards.map((function(e){return Object(g.jsx)(H,{image:e.image})}))})}),Object(g.jsx)("td",{className:I.a.cards,children:Object(g.jsx)("div",{children:e.dealerCards.map((function(e){return Object(g.jsx)(H,{image:e.image})}))})}),Object(g.jsx)("td",{children:e.score})]})}))})]})]})]})}}]),n}(a.Component);L.defaultProps={};var M="GAME_KEY",T="GAME_ROUND_KEY",W=function(e){Object(d.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).raiseBet=function(e){a.setState((function(t){return{bet:t.bet+e}}))},a.state={bet:0,roundNumber:0,betPlaced:!1,roundsResults:[],credit:1e3,resultMessage:""},a.handleEndOfRound=a.handleEndOfRound.bind(Object(b.a)(a)),a.saveGameInLocalStorage=a.saveGameInLocalStorage.bind(Object(b.a)(a)),a.saveGameRound=a.saveGameRound.bind(Object(b.a)(a)),a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.continueLastGame&&this.setState(R.getState(M)),window.addEventListener("beforeunload",this.onWindowClose)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.onWindowClose)}},{key:"handleEndOfRound",value:function(e){var t,n=this;R.saveState(T,null);var a=e.betDoubled?2*this.state.bet:this.state.bet;t="player"===e.winner?this.state.credit+1.5*a:this.state.credit-a,this.setState((function(n){return{roundsResults:[Object(h.a)(Object(h.a)({},e),{},{score:t})].concat(Object(j.a)(n.roundsResults)),betPlaced:!1,credit:t}}),(function(){(5===n.state.roundNumber||n.state.credit<1)&&n.handleEndOfGame();var t="Congratulations! You won this round!";"dealer"===e.winner?t="You lost this round...":"ex aequo"===e.winner&&(t="Ex aequo!"),n.setState({resultMessage:t})}))}},{key:"handleEndOfGame",value:function(){var e={date:(new Date).toLocaleString("en-US"),score:this.state.credit},t=[].concat(Object(j.a)(R.getState(C)||[]),[e]);t.sort((function(e,t){return e.score<=t.score?1:-1})),R.saveState(C,t.slice(0,10))}},{key:"onWindowClose",value:function(e){return(e=e||window.event).preventDefault(),this.saveGameRound(null),e.returnValue="",""}},{key:"canStartNewRound",value:function(){return!this.state.betPlaced&&this.state.roundNumber<5&&this.state.credit>1}},{key:"placeBet",value:function(){this.setState((function(e){return{betPlaced:!0,roundNumber:e.roundNumber+1}}))}},{key:"summaryOfTheGame",value:function(){return this.state.roundsResults.filter((function(e){return"player"===e.winner})).length>=3?Object(g.jsx)("div",{className:f.a.goldText,children:Object(g.jsx)("span",{children:"Congratulations, you won the game!"})}):Object(g.jsx)("div",{className:f.a.goldText,children:Object(g.jsx)("span",{children:"You lost the game!"})})}},{key:"saveGameInLocalStorage",value:function(){R.saveState(M,this.state)}},{key:"saveGameRound",value:function(e){R.saveState(T,e),this.saveGameInLocalStorage()}},{key:"render",value:function(){var e=this,t=this.state.betPlaced&&Object(g.jsx)(P,{deckID:this.props.deckID,continueLastGame:this.props.continueLastGame,onEndOfRound:this.handleEndOfRound,saveGameRound:this.saveGameRound,roundNumber:this.state.roundNumber},this.props.deckID),n=Object(g.jsx)(y,{clickCallback:this.raiseBet}),a=Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{children:n}),Object(g.jsxs)("div",{id:f.a.dealBtns,children:[Object(g.jsx)(u.a,{disabled:0===this.state.bet,onClick:function(){return e.setState({bet:0})},children:"clear"}),Object(g.jsx)(u.a,{className:f.a.Button,disabled:this.state.bet>this.state.credit||0===this.state.bet,onClick:function(){return e.placeBet()},children:"Bet ".concat(this.state.bet,"$")})]})]});return Object(g.jsxs)("div",{className:f.a.Game,"data-testid":"Game",children:[Object(g.jsxs)("div",{id:f.a.credit,children:[Object(g.jsx)("img",{src:"bag-147782_1280.png",alt:"Credit"}),Object(g.jsxs)("span",{children:[this.state.credit,"$"]})]}),t,this.canStartNewRound()&&a,!this.state.betPlaced&&(5===this.state.roundNumber||this.state.credit<1)&&this.summaryOfTheGame(),!this.state.betPlaced&&Object(g.jsx)("div",{id:"appButtons",children:Object(g.jsx)(u.a,{onClick:function(){e.saveGameRound(null),window.confirm("Game has been saved")},children:"Save game"})}),this.state.roundsResults.length>0&&Object(g.jsx)(L,{rounds:this.state.roundsResults}),Object(g.jsx)(m.a,{anchorOrigin:{vertical:"center",horizontal:"center"},className:f.a.Info,autoHideDuration:3e3,open:this.state.bet>this.state.credit,onClose:function(){return e.setState({bet:0})},message:"Your bet is higher than your credit!"}),Object(g.jsx)(m.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:!this.state.betPlaced&&""!==this.state.resultMessage,autoHideDuration:3e3,message:this.state.resultMessage,onClose:function(){return e.setState({resultMessage:""})}})]})}}]),n}(a.Component),A=n(100),Y=n(97),K=n(43),F=n.n(K),J=function(e){var t=e.open,n=e.onClose,a=Object(g.jsxs)("table",{"data-testid":"Ranking",children:[Object(g.jsx)("thead",{children:Object(g.jsxs)("tr",{children:[Object(g.jsx)("th",{children:"Place"}),Object(g.jsx)("th",{children:"Date"}),Object(g.jsx)("th",{children:"Score"})]})}),Object(g.jsx)("tbody",{children:(R.getState(C)||[]).map((function(e,t){return Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{children:t+1}),Object(g.jsx)("td",{children:e.date}),Object(g.jsx)("td",{children:e.score})]},JSON.stringify(e))}))})]});return Object(g.jsxs)(Y.a,{className:F.a.Ranking,maxWidth:"md",fullWidth:!0,open:t,onClose:function(){return n()},children:[Object(g.jsx)(A.a,{children:Object(g.jsx)("span",{className:F.a.goldText,children:"Ranking"})}),a]})};J.defaultProps={};var U=J,z=function(e){Object(d.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).onRankingClose=function(){a.setState({rankingOpened:!1})},a.state={deckID:"",gameState:!1,continueLastGame:!1,rankingOpened:!1},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.shuffle()}},{key:"componentWillUnmount",value:function(){R.saveState("APP_KEY",this.state)}},{key:"onRankingOpen",value:function(){this.setState({rankingOpened:!0})}},{key:"continueGame",value:function(){this.setState({continueLastGame:!0,gameState:!0})}},{key:"startGame",value:function(){this.setState({gameState:!0})}},{key:"shuffle",value:function(){var e=this;fetch("".concat(S,"new/shuffle/?deck_count=6")).then((function(e){return e.json()})).then((function(t){return e.setState({deckID:t.deck_id})}))}},{key:"resetGame",value:function(){this.shuffle(),this.setState({gameState:!1,continueLastGame:!1})}},{key:"render",value:function(){var e=this,t=this.state.gameState&&Object(g.jsx)(W,{deckID:this.state.deckID,continueLastGame:this.state.continueLastGame},this.state.deckID);return Object(g.jsxs)("div",{className:this.state.gameState?"App game":"App beginning",children:[Object(g.jsx)("div",{id:"background"}),Object(g.jsxs)("div",{id:"foreground",children:[Object(g.jsx)("h1",{children:"BLACKJACK"}),t,Object(g.jsxs)("div",{id:"appButtons",children:[this.state.gameState?Object(g.jsx)(u.a,{onClick:function(){return e.resetGame()},children:"New game"}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(u.a,{className:"Button",onClick:function(){return e.startGame()},children:"Play"}),Object(g.jsx)(u.a,{disabled:!R.getState("GAME_KEY"),onClick:function(){return e.continueGame()},children:"Continue game"})]}),Object(g.jsx)(u.a,{onClick:function(){return e.onRankingOpen()},children:"Ranking"})]}),Object(g.jsx)(U,{open:this.state.rankingOpened,onClose:this.onRankingClose})]})]})}}]),n}(a.Component),q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,102)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),s(e),r(e),c(e)}))};c.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(z,{})}),document.getElementById("root")),q()}},[[69,1,2]]]);
//# sourceMappingURL=main.74163c1a.chunk.js.map